<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Discopolia â€“ PaÅ„stwo Zenka</title>
<style>
body { margin:0; font-family: 'Arial', sans-serif; background:#111; color:#fff; text-align:center;}
header { background:linear-gradient(45deg,#ff0066,#ffcc00,#00ffcc); padding:2rem; animation:gradientShift 5s ease infinite; background-size:300% 300%;}
header h1 { margin:0; font-size:3rem; text-shadow:2px 2px 5px #000; }
header p { font-size:1.2rem; text-shadow:1px 1px 3px #000; }
@keyframes gradientShift {0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
main { max-width:900px; margin:2rem auto; padding:0 1rem; }
section { background: rgba(255,255,255,0.05); padding:2rem; margin-bottom:2rem; border-radius:15px; box-shadow:0 0 15px #ff0066; }
h2 { color:#ffcc00; text-shadow:1px 1px 5px #000; }
.mandaty { background:#ff0066; padding:1rem; border-radius:10px; font-weight:bold; cursor:pointer; margin:1rem 0; box-shadow:0 0 10px #ff0066; transition:0.2s;}
.mandaty:hover { transform:scale(1.1); }
.mapa { max-width:100%; border-radius:15px; box-shadow:0 0 20px #ffcc00; }
#gameArea { position:relative; width:100%; max-width:500px; height:400px; margin:1rem auto; border:2px solid #ffcc00; border-radius:15px; background:radial-gradient(circle,#222 40%,#111 100%); overflow:hidden; }
#zenek { position:absolute; width:80px; height:80px; cursor:pointer; display:none; }
#score { font-size:1.3rem; color:#00ffcc; }
.btn { background:#ff0066; border:none; color:#fff; padding:10px 20px; border-radius:10px; cursor:pointer; box-shadow:0 0 10px #ff0066; transition:0.3s; }
.btn:hover { background:#ffcc00; color:#111; }
#ranking table { margin:0 auto; border-collapse:collapse; color:#fff; }
#ranking th, #ranking td { padding:8px 12px; border-bottom:1px solid rgba(255,255,255,0.2); }
input, select { padding:6px; border-radius:6px; border:none; margin:0 5px; }
button.add { padding:6px 12px; background:#00ffcc; color:black; border-radius:6px; cursor:pointer; }
button.add:hover { background:#33ffee; }
.laws { margin-top:1rem; }
.law { background:rgba(255,255,255,0.05); margin:0.5rem 0; padding:0.5rem; border-radius:8px; text-align:left;}
</style>
</head>
<body>
<header>
<h1>Witamy w Discopolii!</h1>
<p>PaÅ„stwie Zenka Martyniuka â€“ Disco paÅ„stwo, gdzie kaÅ¼dy dzieÅ„ to impreza!</p>
</header>
<main>
<section>
<h2>Mandaty Zenkowe</h2>
<div class="mandaty" id="mandatBox">ðŸŽµ Mandaty Zenkowe: <span id="mandatCount">0</span> ðŸŽµ</div>
</section>

<section>
<h2>Mapa Discopolii</h2>
<img src="mapa.png" alt="Mapa Discopolii" class="mapa">
</section>

<section>
<h2>Minigierka: ZÅ‚ap Zenka!</h2>
<div id="gameArea">
<img id="zenek" src="zenek.png" alt="Zenek">
</div>
<p id="score">Wynik: 0</p>
<button class="btn" id="startGame">Start!</button>
</section>

<section id="ranking">
<h2>Ranking Obywateli</h2>
<form id="addCitizen">
<input type="text" id="citizenName" placeholder="Twoje imiÄ™" required>
<select id="citizenTitle">
<option>ZenkoÅ‚ek</option>
<option>Disco-KsiÄ…Å¼Ä™</option>
<option>Super Zenek</option>
<option>KrÃ³l Parkietu</option>
</select>
<button type="submit" class="add">DoÅ‚Ä…cz!</button>
</form>
<table>
<thead><tr><th>ImiÄ™</th><th>TytuÅ‚</th><th>Mandaty</th></tr></thead>
<tbody id="citizenTable"></tbody>
</table>
</section>

<section id="lawsSection">
<h2>Ustawy Discopolii</h2>
<form id="addLaw">
<input type="text" id="lawName" placeholder="Nazwa ustawy" required>
<input type="text" id="lawDesc" placeholder="Opis ustawy" required>
<input type="number" id="lawReq" placeholder="Mandaty wymagane" min="1" required>
<button type="submit" class="add">Zaproponuj ustawÄ™</button>
</form>
<div class="laws" id="lawsList"></div>
<h3>Zatwierdzone ustawy</h3>
<div class="laws" id="approvedLaws"></div>
</section>
</main>
<script>
let globalMandaty=0, boxMandaty=0, score=0, gameActive=false, moveInterval;
let citizens=[], laws=[], approvedLaws=[];
const globalCounter=document.getElementById('mandatCount');
const mandatBox=document.getElementById('mandatBox');
const zenek=document.getElementById('zenek');
const gameArea=document.getElementById('gameArea');
const scoreDisplay=document.getElementById('score');
const startButton=document.getElementById('startGame');
const citizenTable=document.getElementById('citizenTable');
const lawsList=document.getElementById('lawsList');
const approvedList=document.getElementById('approvedLaws');

/* --- LocalStorage --- */
function loadData(){
  globalMandaty=parseInt(localStorage.getItem("globalMandaty"))||0;
  boxMandaty=parseInt(localStorage.getItem("boxMandaty"))||0;
  citizens=JSON.parse(localStorage.getItem("citizens"))||[];
  laws=JSON.parse(localStorage.getItem("laws"))||[];
  approvedLaws=JSON.parse(localStorage.getItem("approvedLaws"))||[];
  updateCounters();
  renderCitizens();
  renderLaws();
  renderApprovedLaws();
}
function saveData(){
  localStorage.setItem("globalMandaty",globalMandaty);
  localStorage.setItem("boxMandaty",boxMandaty);
  localStorage.setItem("citizens",JSON.stringify(citizens));
  localStorage.setItem("laws",JSON.stringify(laws));
  localStorage.setItem("approvedLaws",JSON.stringify(approvedLaws));
}
function updateCounters(){ globalCounter.textContent=boxMandaty; }

/* --- Mandaty --- */
mandatBox.addEventListener('click',()=>{
  boxMandaty++; globalMandaty++; updateCounters(); addPointsToCitizen(1); saveData();
});

/* --- Minigra --- */
function moveZenek(){
  const x=Math.random()*(gameArea.clientWidth-zenek.clientWidth);
  const y=Math.random()*(gameArea.clientHeight-zenek.clientHeight);
  zenek.style.left=x+'px'; zenek.style.top=y+'px';
}
zenek.addEventListener('click',()=>{
  if(!gameActive) return;
  score++; scoreDisplay.textContent="Wynik: "+score;
  globalMandaty++; boxMandaty++; updateCounters(); addPointsToCitizen(1); saveData();
  moveZenek();
});
startButton.addEventListener('click',()=>{
  if(gameActive) return;
  score=0; scoreDisplay.textContent="Wynik: 0";
  gameActive=true; zenek.style.display="block";
  moveZenek(); moveInterval=setInterval(moveZenek,1000);
  setTimeout(()=>{ clearInterval(moveInterval); gameActive=false; zenek.style.display="none"; alert("Koniec gry! Wynik: "+score); },15000);
});

/* --- Ranking --- */
document.getElementById('addCitizen').addEventListener('submit', e=>{
  e.preventDefault();
  const name=document.getElementById('citizenName').value.trim();
  const title=document.getElementById('citizenTitle').value;
  if(!name) return;
  if(!citizens.find(c=>c.name===name)) citizens.push({name,title,points:0});
  renderCitizens(); saveData(); document.getElementById('citizenName').value="";
});
function addPointsToCitizen(pts){
  if(citizens.length===0) return;
  const last=citizens[citizens.length-1]; last.points+=pts;
  citizens.sort((a,b)=>b.points-a.points);
  renderCitizens(); saveData();
}
function renderCitizens(){
  citizenTable.innerHTML=""; citizens.forEach(c=>{
    const row=document.createElement('tr');
    row.innerHTML=`<td>${c.name}</td><td>${c.title}</td><td>${c.points}</td>`;
    citizenTable.appendChild(row);
  });
}

/* --- Ustawy --- */
document.getElementById('addLaw').addEventListener('submit',e=>{
  e.preventDefault();
  const name=document.getElementById('lawName').value.trim();
  const desc=document.getElementById('lawDesc').value.trim();
  const req=parseInt(document.getElementById('lawReq').value);
  if(!name || !desc || !req) return;
  laws.push({name,desc,votes:0,required:req});
  renderLaws(); saveData();
  document.getElementById('lawName').value="";
  document.getElementById('lawDesc').value="";
  document.getElementById('lawReq').value="";
});
function renderLaws(){
  lawsList.innerHTML="";
  laws.forEach((law,i)=>{
    const div=document.createElement('div'); div.className='law';
    div.innerHTML=`<strong>${law.name}</strong> (${law.votes}/${law.required} MZ)<br>${law.desc}<br>
    <input type="number" min="1" placeholder="IloÅ›Ä‡ MZ" id="donate${i}"> <button class="add">PrzekaÅ¼ mandaty</button>`;
    div.querySelector('button').addEventListener('click',()=>{
      const amt=parseInt(document.getElementById('donate'+i).value);
      if(!amt || citizens.length===0) return alert("Podaj iloÅ›Ä‡ mandatÃ³w!");
      const citizen=citizens[citizens.length-1];
      if(amt>citizen.points) return alert("Nie masz tyle mandatÃ³w!");
      citizen.points-=amt; boxMandaty-=amt; if(boxMandaty<0) boxMandaty=0;
      globalMandaty-=amt; if(globalMandaty<0) globalMandaty=0;
      law.votes+=amt;
      if(law.votes>=law.required){ approvedLaws.push(law); laws=laws.filter(l=>l!==law);}
      renderCitizens(); renderLaws(); renderApprovedLaws(); updateCounters(); saveData();
    });
    lawsList.appendChild(div);
  });
}
function renderApprovedLaws(){
  approvedList.innerHTML="";
  approvedLaws.forEach(law=>{
    const div=document.createElement('div'); div.className='law';
    div.innerHTML=`<strong>${law.name}</strong> (${law.votes} MZ)<br>${law.desc}`;
    approvedList.appendChild(div);
  });
}
loadData();
</script>
</body>
</html>
