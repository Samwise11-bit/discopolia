<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Discopolia ‚Äì Pa≈Ñstwo Zenka</title>
<style>
body {
  margin: 0;
  font-family: 'Poppins', sans-serif;
  background: radial-gradient(circle at top, #25003a, #000);
  color: #fff;
  text-align: center;
  overflow-x: hidden;
}

header {
  background: linear-gradient(45deg, #ff00cc, #3333ff, #ffcc00);
  background-size: 300% 300%;
  animation: gradientMove 6s ease infinite;
  padding: 2rem;
  position: relative;
  box-shadow: 0 0 20px #ff00cc;
}
@keyframes gradientMove {
  0% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}

header img {
  width: 120px;
  position: absolute;
  top: 10px;
  left: 10px;
}

header h1 {
  font-size: 3rem;
  margin: 0;
  text-shadow: 3px 3px 8px #000;
}

header p {
  font-size: 1.2rem;
  margin-top: 0.5rem;
  color: #ffeb99;
}

#totalMandatyBox {
  position: fixed;
  top: 10px;
  left: 10px;
  background: rgba(255, 0, 204, 0.8);
  padding: 10px 20px;
  border-radius: 10px;
  box-shadow: 0 0 15px #ff00cc;
  font-weight: bold;
  font-size: 1.1rem;
  z-index: 9999;
}

main {
  max-width: 900px;
  margin: 2rem auto;
  padding: 0 1rem;
}

section {
  background: rgba(255,255,255,0.05);
  padding: 2rem;
  margin-bottom: 2rem;
  border-radius: 15px;
  box-shadow: 0 0 20px #ff00cc;
}

h2 {
  color: #ffcc00;
  text-shadow: 0 0 10px #ffcc00;
}

/* --- Klikacz mandacik√≥w --- */
#mandatBox {
  background: linear-gradient(135deg, #ff0099, #ff6600);
  border-radius: 20px;
  padding: 2rem;
  margin: 1.5rem auto;
  max-width: 300px;
  font-size: 1.3rem;
  font-weight: bold;
  cursor: pointer;
  box-shadow: 0 0 20px #ff00cc;
  transition: transform 0.2s, box-shadow 0.2s;
}
#mandatBox:hover {
  transform: scale(1.1);
  box-shadow: 0 0 30px #ffcc00;
}

.mapa {
  max-width: 100%;
  border-radius: 15px;
  box-shadow: 0 0 20px #ffcc00;
}

#gameArea {
  position: relative;
  width: 100%;
  max-width: 500px;
  height: 400px;
  margin: 1rem auto;
  border: 2px solid #ffcc00;
  border-radius: 15px;
  background: radial-gradient(circle, #222 40%, #111 100%);
  overflow: hidden;
}

#zenek {
  position: absolute;
  width: 80px;
  height: 80px;
  cursor: pointer;
  display: none;
}

#score {
  font-size: 1.3rem;
  color: #00ffcc;
}

.btn {
  background: #ff0066;
  border: none;
  color: #fff;
  padding: 10px 20px;
  border-radius: 10px;
  cursor: pointer;
  box-shadow: 0 0 10px #ff0066;
  transition: 0.3s;
}
.btn:hover { background: #ffcc00; color: #111; }

#ranking table {
  margin: 0 auto;
  border-collapse: collapse;
  color: #fff;
}
#ranking th, #ranking td {
  padding: 8px 12px;
  border-bottom: 1px solid rgba(255,255,255,0.2);
}

input, select {
  padding: 6px;
  border-radius: 6px;
  border: none;
  margin: 0 5px;
}
button.add {
  padding: 6px 12px;
  background: #00ffcc;
  color: black;
  border-radius: 6px;
  cursor: pointer;
}
button.add:hover { background: #33ffee; }

.laws { margin-top: 1rem; }
.law {
  background: rgba(255,255,255,0.05);
  margin: 0.5rem 0;
  padding: 0.5rem;
  border-radius: 8px;
  text-align: left;
}
</style>
</head>
<body>
<header>
  <img src="herb.png" alt="Herb Discopolii">
  <h1>Witamy w Discopolii!</h1>
  <p>Pa≈Ñstwo Zenka Martyniuka ‚Äì gdzie ka≈ºda noc to koncert!</p>
</header>

<div id="totalMandatyBox">üí∞ ≈ÅƒÖcznie Mandat√≥w: <span id="totalMandaty">0</span> MZ</div>

<main>
<section>
  <h2>Mandaty Zenkowe</h2>
  <div id="mandatBox">üéµ Kliknij, by zdobywaƒá Mandaty Zenkowe!</div>
</section>

<section>
  <h2>Mapa Discopolii</h2>
  <img src="mapa.png" alt="Mapa Discopolii" class="mapa">
</section>

<section>
  <h2>Minigierka: Z≈Çap Zenka!</h2>
  <div id="gameArea">
    <img id="zenek" src="zenek.png" alt="Zenek">
  </div>
  <p id="score">Wynik: 0</p>
  <button class="btn" id="startGame">Start!</button>
</section>

<section id="ranking">
  <h2>Ranking Obywateli</h2>
  <form id="addCitizen">
    <input type="text" id="citizenName" placeholder="Twoje imiƒô" required>
    <select id="citizenTitle">
      <option>Zenko≈Çek</option>
      <option>Disco-KsiƒÖ≈ºƒô</option>
      <option>Super Zenek</option>
      <option>Kr√≥l Parkietu</option>
    </select>
    <button type="submit" class="add">Do≈ÇƒÖcz!</button>
  </form>
  <table>
    <thead><tr><th>Imiƒô</th><th>Tytu≈Ç</th><th>Mandaty</th></tr></thead>
    <tbody id="citizenTable"></tbody>
  </table>
</section>

<section id="lawsSection">
  <h2>Ustawy Discopolii</h2>
  <form id="addLaw">
    <input type="text" id="lawName" placeholder="Nazwa ustawy" required>
    <input type="text" id="lawDesc" placeholder="Opis ustawy" required>
    <input type="number" id="lawReq" placeholder="Mandaty wymagane" min="1" required>
    <button type="submit" class="add">Zaproponuj ustawƒô</button>
  </form>
  <div class="laws" id="lawsList"></div>
  <h3>Zatwierdzone ustawy</h3>
  <div class="laws" id="approvedLaws"></div>
</section>
</main>

<script>
let globalMandaty=0,score=0,gameActive=false,moveInterval;
let citizens=[],laws=[],approvedLaws=[];
const totalMandatyDisplay=document.getElementById('totalMandaty');
const mandatBox=document.getElementById('mandatBox');
const zenek=document.getElementById('zenek');
const gameArea=document.getElementById('gameArea');
const scoreDisplay=document.getElementById('score');
const startButton=document.getElementById('startGame');
const citizenTable=document.getElementById('citizenTable');
const lawsList=document.getElementById('lawsList');
const approvedList=document.getElementById('approvedLaws');

/* --- LocalStorage --- */
function loadData(){
  globalMandaty=parseInt(localStorage.getItem("globalMandaty"))||0;
  citizens=JSON.parse(localStorage.getItem("citizens"))||[];
  laws=JSON.parse(localStorage.getItem("laws"))||[];
  approvedLaws=JSON.parse(localStorage.getItem("approvedLaws"))||[];
  updateDisplay(); renderCitizens(); renderLaws(); renderApprovedLaws();
}
function saveData(){
  localStorage.setItem("globalMandaty",globalMandaty);
  localStorage.setItem("citizens",JSON.stringify(citizens));
  localStorage.setItem("laws",JSON.stringify(laws));
  localStorage.setItem("approvedLaws",JSON.stringify(approvedLaws));
}
function updateDisplay(){ totalMandatyDisplay.textContent=globalMandaty; }

/* --- Klikanie Mandat√≥w --- */
mandatBox.addEventListener('click',()=>{
  globalMandaty++;
  addPointsToCitizen(1);
  updateDisplay(); saveData();
});

/* --- Minigra --- */
function moveZenek(){
  const x=Math.random()*(gameArea.clientWidth-zenek.clientWidth);
  const y=Math.random()*(gameArea.clientHeight-zenek.clientHeight);
  zenek.style.left=x+'px';
  zenek.style.top=y+'px';
}
zenek.addEventListener('click',()=>{
  if(!gameActive) return;
  score++;
  scoreDisplay.textContent="Wynik: "+score;
  globalMandaty++; addPointsToCitizen(1);
  updateDisplay(); saveData();
  moveZenek();
});
startButton.addEventListener('click',()=>{
  if(gameActive) return;
  score=0; scoreDisplay.textContent="Wynik: 0";
  gameActive=true; zenek.style.display="block";
  moveZenek(); moveInterval=setInterval(moveZenek,1000);
  setTimeout(()=>{
    clearInterval(moveInterval);
    gameActive=false;
    zenek.style.display="none";
    alert("Koniec gry! Wynik: "+score);
  },15000);
});

/* --- Ranking --- */
document.getElementById('addCitizen').addEventListener('submit',e=>{
  e.preventDefault();
  const name=document.getElementById('citizenName').value.trim();
  const title=document.getElementById('citizenTitle').value;
  if(!name) return;
  if(!citizens.find(c=>c.name===name))
    citizens.push({name,title,points:0});
  renderCitizens(); saveData();
  document.getElementById('citizenName').value="";
});
function addPointsToCitizen(pts){
  if(citizens.length===0) return;
  const last=citizens[citizens.length-1];
  last.points+=pts;
  citizens.sort((a,b)=>b.points-a.points);
  renderCitizens(); saveData();
}
function renderCitizens(){
  citizenTable.innerHTML="";
  citizens.forEach(c=>{
    const row=document.createElement('tr');
    row.innerHTML=`<td>${c.name}</td><td>${c.title}</td><td>${c.points}</td>`;
    citizenTable.appendChild(row);
  });
}

/* --- Ustawy --- */
document.getElementById('addLaw').addEventListener('submit',e=>{
  e.preventDefault();
  const name=document.getElementById('lawName').value.trim();
  const desc=document.getElementById('lawDesc').value.trim();
  const req=parseInt(document.getElementById('lawReq').value);
  if(!name||!desc||!req) return;
  laws.push({name,desc,votes:0,required:req});
  renderLaws(); saveData(); e.target.reset();
});
function renderLaws(){
  lawsList.innerHTML="";
  laws.forEach((law,i)=>{
    const div=document.createElement('div');
    div.className='law';
    div.innerHTML=`<strong>${law.name}</strong> (${law.votes}/${law.required} MZ)<br>${law.desc}<br>
    <input type="number" min="1" placeholder="Ilo≈õƒá MZ" id="donate${i}">
    <button class="add">Przeka≈º mandaty</button>`;
    div.querySelector('button').addEventListener('click',()=>{
      const amt=parseInt(document.getElementById('donate'+i).value);
      if(!amt||citizens.length===0) return alert("Podaj ilo≈õƒá mandat√≥w!");
      const citizen=citizens[citizens.length-1];
      if(amt>citizen.points) return alert("Nie masz tyle mandat√≥w!");
      citizen.points-=amt; globalMandaty-=amt; if(globalMandaty<0) globalMandaty=0;
      law.votes+=amt;
      if(law.votes>=law.required){
        approvedLaws.push(law);
        laws=laws.filter(l=>l!==law);
      }
      renderCitizens(); renderLaws(); renderApprovedLaws();
      updateDisplay(); saveData();
    });
    lawsList.appendChild(div);
  });
}
function renderApprovedLaws(){
  approvedList.innerHTML="";
  approvedLaws.forEach(law=>{
    const div=document.createElement('div');
    div.className='law';
    div.innerHTML=`<strong>${law.name}</strong> (${law.votes} MZ)<br>${law.desc}`;
    approvedList.appendChild(div);
  });
}
loadData();
</script>
</body>
</html>
